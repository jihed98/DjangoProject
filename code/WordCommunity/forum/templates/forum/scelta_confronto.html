{%  extends 'base.html' %}

{% block content %}


        <div style="width: 100%;height: 45rem;overflow: hidden scroll;">
            <table  id="table" class="table table-striped table-bordered" style="width:100%;">
                <thead>
                <tr>
                    <th scope="col-4">Titolo Articolo</th>
                    <th> Autore Articolo </th>
                    <th> Indice di Complessità </th>
                    <th class="no-sort"> Scegli </th>
                </tr>
                </thead>
                <tbody>
                 {% for articolo in articoli %}
                <tr scope="row" id="{{articolo.id}}">
                        <td>{{ articolo.titolo }}</td>
                        <td>{{ articolo.autore_articolo }}</td>
                        <td>{{ articolo.indice }}</td>
                        <td> <a class="btn btn-success"> <i class="fa fa-exchange"></i></a></td>

                </tr>
                 {% endfor %}
                </tbody>
            </table>
        </div>

    </div>


<div class="container p-3 my-3 bg-dark text-white">
    <div class="d-flex justify-content-center">
    Hai selezionato:
    </div>
    <div id="art1" class="d-flex justify-content-center">
        <h6> 1° Articolo: &nbsp; </h6>
        <h6 name="id" style="display: none"></h6>
        <h6 name="titolo"></h6>
    </div>
    <div id="art2" class="d-flex justify-content-center">
        <h6> 2° Articolo: &nbsp;</h6>
        <h6 name="id" style="display: none"></h6>
        <h6 name="titolo"></h6>
    </div>
    <div class="d-flex justify-content-center">
    <a id="confronta" class="btn btn-success">Conferma</a>
    </div>
</div>

{% endblock %}

{% block javascript %}
    <script>
        $(document).ready(function(){
            $(function() {

                $("#table").on('click', '.btn', function(e) {
                    var currentRow = $(this).closest("tr");
                    var artId = currentRow.attr('id')
                    var titolo = currentRow.find("td:eq(0)").html();


                    var v = $("#art1").find('h6[name="id"]').html();
                    var v2 = $("#art2").find('h6[name="id"]').html()

                    if (v == '' && v2=='') {
                        $("#art1").find('h6[name="id"]').html(artId);
                        $("#art1").find('h6[name="titolo"]').html(titolo);
                    }
                    else if (v2=='') {
                        $("#art2").find('h6[name="id"]').html(artId);
                        $("#art2").find('h6[name="titolo"]').html(titolo);
                    }
                    else {
                        var oldId =  $("#art2").find('h6[name="id"]').html();
                        var oldTitle = $("#art2").find('h6[name="titolo"]').html();

                        $("#art1").find('h6[name="id"]').html(oldId);
                        $("#art1").find('h6[name="titolo"]').html(oldTitle);

                        $("#art2").find('h6[name="id"]').html(artId);
                        $("#art2").find('h6[name="titolo"]').html(titolo);
                    }



                    });
            });
            $(function() {
                $('#table').DataTable({bFilter: true, bInfo:false, paging:false, lengthChange: false,
                columnDefs:[{
                    orderable: false,
                    targets:"no-sort"
                }]});
            });
        });
    </script>

    <script>
        $("#confronta").on('click', function (e) {
            var id1 = $("#art1").find('h6[name="id"]').html()
            var id2 = $("#art2").find('h6[name="id"]').html()

            if (id1=='' || id2=='') {
                alert("Devi selezionare due articoli!")
                return false
            }

            myurl = id1 + '/' + id2 + '/'
            window.location.href=myurl

        })
    </script>
{% endblock %}